<!DOCTYPE html>
<html>
<head>
  <title>Contact Support</title>
</head>
<body>

<div class="box">
  <h2>Contact Support</h2>

  <!-- IMPORTANT: id MUST exist -->
<form id="contactForm">
  <input id="name" placeholder="Your Name" required>
  <input id="email" type="email" placeholder="Your Email" required>
  <textarea id="message" placeholder="Describe your issue" required></textarea>
  <button type="submit">Send</button>
</form>
</div>

<script>
const printerModel = sessionStorage.getItem("printerModel");

// üö® SAFETY CHECK
if (!printerModel) {
  alert("Printer model missing. Please start again.");
  window.location.href = "/hp123";
}

document.getElementById("contactForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const payload = {
    name: document.getElementById("name").value.trim(),
    email: document.getElementById("email").value.trim(),
    message: document.getElementById("message").value.trim(),
    printerModel: printerModel
  };

  const res = await fetch("/send-contact", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  if (res.ok) {
    alert("‚úÖ Message sent successfully");
    this.reset();
    sessionStorage.removeItem("printerModel");
  } else {
    alert("‚ùå Failed to send message");
  }
});
</script>


</body>
</html>
